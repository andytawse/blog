<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charset="utf-8" /><meta name="Generator" content="Drupal 11 (https://www.drupal.org)" /><meta name="MobileOptimized" content="width" /><meta name="HandheldFriendly" content="true" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://www.andytawse.co.uk/blog/debugging-google-cloud-run-functions-when-running-functions-emulator" /><link rel="shortlink" href="https://www.andytawse.co.uk/node/9" /><title>Debugging Google Cloud Run functions when running in Functions Emulator | Andy&#039;s Blog</title><link rel="stylesheet" media="all" href="/sites/default/files/css/css_98cfU8TK4SOL6LJvIuZBUQfgTv_fKFQQx0wNzSc-Hds.css?delta=0&amp;language=en&amp;theme=basicblog&amp;include=eJxLSizOTE7KyU_XT8_JT0rM0S0uqczJzEsHAHWWCX4" /></head><body> <a href="#main-content" class="visually-hidden focusable"> Skip to main content </a><div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas><div class="layout-container"><div data-drupal-messages-fallback class="hidden"></div> <header role="banner"><div id="block-basicblog-site-branding"> <a href="/" rel="home">Andy&#039;s Blog</a></div><nav role="navigation" aria-labelledby="block-basicblog-main-menu-menu" id="block-basicblog-main-menu"><h2 class="visually-hidden" id="block-basicblog-main-menu-menu">Main navigation</h2><ul><li> <a href="/" data-drupal-link-system-path="&lt;front&gt;">Home</a></li><li> <a href="/about-me" data-drupal-link-system-path="node/3">About Me</a></li></ul> </nav><div id="block-basicblog-siteinfo"><div><p>This site is intended to be simple, back-to-basics, low-impact and fast.</p></div></div> </header> <main role="main"> <a id="main-content" tabindex="-1"></a><div class="layout-content"><div id="block-basicblog-page-title"><h1><span>Debugging Google Cloud Run functions when running in Functions Emulator</span></h1></div><div id="block-basicblog-content"> <article class="full"> <footer><div> Published: <span><time datetime="2024-12-17T17:27:35+00:00" title="Tuesday, December 17, 2024 - 17:27">17 December 2024</time></span></div> </footer><div><div><p>I'm using the gcloud CLI to deploy and call functions.</p><pre><code class="language-plaintext">gcloud alpha functions local deploy ... --verbosity=debug
gcloud alpha functions local call ... --verbosity=debug</code></pre><p>To start with, it's best to set verbosity to debug.</p><p>Sometimes a function will look like it's deployed successfully and then give a 500, or an error like&nbsp;</p><pre><code class="language-plaintext">gcloud crashed (ConnectionError): HTTPConnectionPool(host='localhost', port=80): Max retries exceeded with url...</code></pre><p>With <a href="https://cloud.google.com/functions/docs/running/functions-emulator">Functions Emulator</a>, there's a Docker container somewhere that runs or attempts to run. If it's running you can find it's ID with <code>docker ps</code>. If it's not running, you can find the container ID in the deploy output (it's the 64 character hex string you'll see).</p><p>Once you have the ID, you can check it's logs - <code>docker logs &lt;ID&gt;</code>. That's how I've been finding most of my errors.</p><p>Functions Emulator is fine once you figure it out. The context that a Cloud Run function exists in needs to be recreated locally and this seems like the best way.</p><p>It's nice that it takes care of the Docker details, but you can still make use of the underlying tools to find out what's going on. There's nothing worse than not being able to see what errors you're causing after you've run some code.</p></div><div class="tags"><div><a href="/taxonomy/term/1" hreflang="en">Google Cloud Run Functions</a></div><div><a href="/taxonomy/term/2" hreflang="en">Google Functions Emulator</a></div><div><a href="/taxonomy/term/9" hreflang="en">Docker</a></div></div></div></article></div></div> </main></div></div></body></html>